<!DOCTYPE html>
<!-- saved from url=(0129)https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Gradient Checking v1</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Gradient Checking v1_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Gradient Checking v1_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Gradient Checking v1_files/MathJax.js.下载" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Gradient Checking v1_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Gradient Checking v1_files/codemirror.css">


    <link rel="stylesheet" href="./Gradient Checking v1_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Gradient Checking v1_files/override.css" type="text/css">
<link rel="stylesheet" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Gradient Checking v1_files/custom.css" type="text/css">
    <script src="./Gradient Checking v1_files/promise.min.js.下载" type="text/javascript" charset="utf-8"></script>
    <script src="./Gradient Checking v1_files/index.js.下载" type="text/javascript"></script>
    <script src="./Gradient Checking v1_files/index.js(1).下载" type="text/javascript"></script>
    <script src="./Gradient Checking v1_files/index.js(2).下载" type="text/javascript"></script>
    <script src="./Gradient Checking v1_files/require.js.下载" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20171111085620",
          
          baseUrl: '/user/dwhpzgfgrvvvjixquyviwa/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/user/dwhpzgfgrvvvjixquyviwa/custom',
            nbextensions : '/user/dwhpzgfgrvvvjixquyviwa/nbextensions',
            kernelspecs : '/user/dwhpzgfgrvvvjixquyviwa/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Gradient Checking v1_files/contents.js.下载"></script><style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
.en-markup-crop-options {
    top: 18px !important;
    left: 50% !important;
    margin-left: -100px !important;
    width: 200px !important;
    border: 2px rgba(255,255,255,.38) solid !important;
    border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
    margin-left: 0px !important;
}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Gradient Checking v1_files/custom.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/jupyter-js-widgets/extension" src="./Gradient Checking v1_files/extension.js.下载"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit_button/main" src="./Gradient Checking v1_files/main.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.widget-modal-backdrop{position:absolute;left:0;top:0;width:100%;height:100%;background:#000;z-index:999;opacity:.5;display:flex;align-items:center;justify-content:center;flex-direction:column}.widget-modal-backdrop.widget-modal-hidden{display:none}.widget-modal-backdrop.widget-modal-hide{animation:fadeout .25s}.widget-modal-backdrop.widget-modal-show{animation:fadein .25s}@keyframes fadein{from{opacity:0}to{opacity:.5}}@keyframes fadeout{from{opacity:.5}to{opacity:0}}.widget-modal-text{color:#fff;font-size:x-large;font-weight:700}.widget-modal-text div,.widget-modal-text i{display:inline}.widget-modal-text div{padding-left:1ex}.widget-modal-progress{width:300px}.jupyter-widgets{margin:2px}.jupyter-widgets.widget-container{margin:0}.widget-area{page-break-inside:avoid;-webkit-box-orient:horizontal;-webkit-box-align:stretch;-moz-box-orient:horizontal;-moz-box-align:stretch;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}.widget-area .widget-subarea{padding:.4em 0;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;-webkit-box-flex:2;-moz-box-flex:2;box-flex:2;flex:2;-webkit-box-orient:vertical;-webkit-box-align:stretch;-moz-box-orient:vertical;-moz-box-align:stretch;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}.widget-area.connection-problems .prompt:after{content:"\F127";font-family:FontAwesome;color:#d9534f;top:3px;padding:3px}.slide-track{border:1px solid #CCC;background:#FFF;border-radius:2px}.widget-hslider{width:300px}.widget-hslider .slider-container{padding-left:8px;padding-right:2px;overflow:visible;flex-grow:1;height:5px;max-height:5px;margin-top:15px;margin-bottom:12px;border:1px solid #CCC;background:#FFF;border-radius:2px;-webkit-box-orient:horizontal;-webkit-box-align:stretch;-moz-box-orient:horizontal;-moz-box-align:stretch;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}.widget-hslider .slider-container .ui-slider{-webkit-box-orient:horizontal;-webkit-box-align:stretch;-moz-box-orient:horizontal;-moz-box-align:stretch;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;border:0;background:0 0}.widget-hslider .slider-container .ui-slider .ui-slider-handle{width:12px;height:28px;margin-top:-8px;border-radius:2px}.widget-hslider .slider-container .ui-slider .ui-slider-range{height:12px;margin-top:-4px}.widget-vslider{width:50px;height:250px}.widget-vslider .slider-container{padding-bottom:5px;overflow:visible;flex-grow:1;width:5px;max-width:5px;margin-left:auto;margin-right:auto;border:1px solid #CCC;background:#FFF;border-radius:2px;-webkit-box-orient:vertical;-webkit-box-align:stretch;-moz-box-orient:vertical;-moz-box-align:stretch;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}.widget-vslider .slider-container .ui-slider{-webkit-box-orient:vertical;-webkit-box-align:stretch;-moz-box-orient:vertical;-moz-box-align:stretch;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;border:0;background:0 0;margin-left:-4px;margin-top:5px}.widget-vslider .slider-container .ui-slider .ui-slider-handle{width:28px;height:12px;margin-left:-9px;border-radius:2px}.widget-vslider .slider-container .ui-slider .ui-slider-range{width:12px;margin-left:-1px}.widget-colorpicker{width:300px;display:flex}.widget-colorpicker.short{width:148px}.widget-colorpicker .input-group{flex-grow:1}.jupyter-button{width:148px;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.jupyter-button.btn,.jupyter-button.btn.hover,.jupyter-button.btn:active,.jupyter-button.btn:focus{outline:0!important}.jupyter-button.btn:active{box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2)}.widget-checkbox{width:148px}.widget-button,.widget-toggle-button{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);width:148px;height:32px}.widget-button.btn,.widget-button.btn.hover,.widget-button.btn:active,.widget-button.btn:focus,.widget-toggle-button.btn,.widget-toggle-button.btn.hover,.widget-toggle-button.btn:active,.widget-toggle-button.btn:focus{outline:0!important}.widget-button.btn:active,.widget-toggle-button.btn:active{box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2)}.widget-play{width:148px;display:flex;justify-content:space-between}.widget-play button{height:32px;width:48px}.widget-toggle-button{width:148px;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.widget-toggle-button.btn,.widget-toggle-button.btn.hover,.widget-toggle-button.btn:active,.widget-toggle-button.btn:focus,.widget-toggle-buttons .btn,.widget-toggle-buttons .btn.hover,.widget-toggle-buttons .btn:active,.widget-toggle-buttons .btn:focus{outline:0!important}.widget-toggle-buttons .btn.active{box-shadow:none!important}.widget-toggle-buttons .btn-group{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.widget-text{width:300px}.widget-textarea{width:300px}.widget-listbox{width:300px}.widget-select-multiple{width:300px}.widget-select-multiple select.form-control{margin-left:0;margin-right:0}.widget-dropdown{width:300px}.widget-dropdown .widget_item{display:flex;flex-grow:1}.widget-dropdown .widget-combo-btn{flex-grow:1;min-width:10px}.widget-dropdown .dropdown-menu{max-height:200px;overflow:hidden;overflow-y:auto;width:calc(275px)}.widget-hprogress{width:300px;height:32px}.widget-hprogress .progress{flex-grow:1;margin-top:auto;margin-bottom:auto}.widget-hprogress .progress-bar{-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none;transition:none}.widget-vprogress{height:250px;width:50px}.widget-vprogress .progress{flex-grow:1;width:12px;margin-left:auto;margin-right:auto;margin-bottom:0}.widget-vprogress .progress-bar{-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none;transition:none}.widget-combo-btn{min-width:123px}.widget_item .dropdown-menu li a{color:inherit}.widget-valid{margin:8px 5px 16px}.widget-hbox{-webkit-box-orient:horizontal;-webkit-box-align:stretch;-moz-box-orient:horizontal;-moz-box-align:stretch;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}.widget-hbox input[type=checkbox]{margin-top:10px;margin-bottom:10px}.widget-hbox input[type=color]{height:32px;width:28px;padding:1px}.widget-hbox .widget-label{min-width:10ex;max-width:10ex;padding-right:8px;padding-top:5px;text-align:right;vertical-align:text-top;word-wrap:break-word}.widget-hbox .widget-readout{padding-left:4px;padding-top:5px;height:32px;text-align:center;vertical-align:text-top;min-width:7em;max-width:7em;margin-left:3px;overflow:hidden;white-space:nowrap}.widget-hbox .widget-readout.overflow{-webkit-box-shadow:0 0 0 1px rgba(77,0,0,.15);-moz-box-shadow:0 0 0 1px rgba(77,0,0,.15);box-shadow:0 0 0 1px rgba(77,0,0,.15)}.widget-vbox{-webkit-box-orient:vertical;-webkit-box-align:stretch;-moz-box-orient:vertical;-moz-box-align:stretch;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}.widget-vbox input[type=color]{height:32px;padding:1px}.widget-vbox .widget-label{padding-bottom:5px;text-align:center;vertical-align:text-bottom}.widget-vbox .widget-readout{padding-top:5px;white-space:nowrap;text-align:center;vertical-align:text-top;margin-top:4px;overflow:hidden}.widget-vbox .widget-readout.overflow{-webkit-box-shadow:0 0 0 1px rgba(77,0,0,.15);-moz-box-shadow:0 0 0 1px rgba(77,0,0,.15);box-shadow:0 0 0 1px rgba(77,0,0,.15)}.widget-box{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;-webkit-box-align:start;-moz-box-align:start;box-align:start;align-items:flex-start}.widget-radio-box{-webkit-box-orient:vertical;-webkit-box-align:stretch;-moz-box-orient:vertical;-moz-box-align:stretch;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding-top:4px}.widget-radio-box label{margin-top:2px;margin-bottom:2px;margin-left:22px}/*# sourceMappingURL=widgets.min.css.map */</style><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main-italic; src: url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
</style><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://hub.coursera-notebooks.org/static/base/images/favicon.ico"></head>

<body class="notebook_app command_mode" data-base-url="/user/dwhpzgfgrvvvjixquyviwa/" data-ws-url="" data-notebook-name="Gradient%20Checking%20v1.ipynb" data-notebook-path="week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb" dir="ltr"><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div>

<noscript>
    &lt;div id='noscript'&gt;
      Jupyter Notebook requires JavaScript.&lt;br&gt;
      Please enable it to proceed.
  &lt;/div&gt;
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/tree" title="dashboard">
<img src="./Gradient Checking v1_files/logo" alt="Jupyter Notebook">
</a></div>

  

  
  

    <span id="login_widget">
      
        <button id="logout" class="btn btn-sm navbar-btn">Logout</button>
      
    </span>

  

  

<a href="https://hub.coursera-notebooks.org/hub/home" class="btn btn-default btn-sm navbar-btn pull-right" style="margin-right: 4px; margin-left: 2px;">
Control Panel</a>


  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Gradient Checking v1</span>
    <span class="checkpoint_status" title="Sat, Nov 11, 2017 9:36 PM">Last Checkpoint: a minute ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="./Gradient Checking v1_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Trusted</span></div><div id="notification_widgets" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python3"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Saturday, November 11, 2017 9:36 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Delete Cells</a></li>
                        <li id="undelete_cell" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python3"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" data-toggle="dropdown" class="dropdown-toggle">Widgets</a><ul id="widget-submenu" class="dropdown-menu"><li title="Rasterizes the current state of the widgets to the notebook as PNG images."><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Save notebook with snapshots</a></li><li title="Download the widget state as a JSON file"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Download widget state</a></li><li title="Embed interactive widgets"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Embed widgets</a></li></ul></li><li class="dropdown"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/3.6?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20171111085620"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div><div class="btn-group" id="submit-notebook-button-group" style="float:right"><button class="btn btn-default" title="Submit this notebook for grading." id="submit-notebook-button" style="background-color:rgb(42, 115, 204); color:white; padding:4px 8px">Submit Assignment</button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 611px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 236px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Gradient Checking</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Welcome to the final assignment for this week! In this assignment you will learn to implement and use gradient checking. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You are part of a team working to make mobile payments available globally, and are asked to build a deep learning model to detect fraud--whenever someone makes a payment, you want to see if the payment might be fraudulent, such as if the user's account has been taken over by a hacker. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">But backpropagation is quite challenging to implement, and sometimes has bugs. Because this is a mission-critical application, your company's CEO wants to be really certain that your implementation of backpropagation is correct. Your CEO says, "Give me a proof that your backpropagation is actually working!" To give this reassurance, you are going to use "gradient checking".</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's do it!</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 236px;"></div><div class="CodeMirror-gutters" style="display: none; height: 249px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Gradient-Checking">Gradient Checking<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#Gradient-Checking">¶</a></h1>
<p>Welcome to the final assignment for this week! In this assignment you will learn to implement and use gradient checking. </p>
<p>You are part of a team working to make mobile payments available globally, and are asked to build a deep learning model to detect fraud--whenever someone makes a payment, you want to see if the payment might be fraudulent, such as if the user's account has been taken over by a hacker. </p>
<p>But backpropagation is quite challenging to implement, and sometimes has bugs. Because this is a mission-critical application, your company's CEO wants to be really certain that your implementation of backpropagation is correct. Your CEO says, "Give me a proof that your backpropagation is actually working!" To give this reassurance, you are going to use "gradient checking".</p>
<p>Let's do it!</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 698.734px; margin-bottom: -17px; border-right-width: 13px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># Packages</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">testCases</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">gc_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">sigmoid</span>, <span class="cm-variable">relu</span>, <span class="cm-variable">dictionary_to_vector</span>, <span class="cm-variable">vector_to_dictionary</span>, <span class="cm-variable">gradients_to_vector</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 422px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1) How does gradient checking work?</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Backpropagation computes the gradients <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>, where <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span> denotes the parameters of the model. <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> is computed using forward propagation and your loss function.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Because forward propagation is relatively easy to implement, you're confident you got that right, and so you're almost  100% sure that you're computing the cost <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> correctly. Thus, you can use your code for computing <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> to verify the code for computing <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's look back at the definition of a derivative (or gradient):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span> = <span class="cm-tag">\lim</span>_<span class="cm-bracket">{</span><span class="cm-tag">\varepsilon</span> <span class="cm-tag">\to</span> <span class="cm-atom">0</span><span class="cm-bracket">}</span> <span class="cm-tag">\frac</span><span class="cm-bracket">{</span>J(<span class="cm-tag">\theta</span> + <span class="cm-tag">\varepsilon</span>) - J(<span class="cm-tag">\theta</span> - <span class="cm-tag">\varepsilon</span>)<span class="cm-bracket">}{</span><span class="cm-atom">2</span> <span class="cm-tag">\varepsilon</span><span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">1</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">If you're not familiar with the "<span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\displaystyle</span> <span class="cm-tag">\lim</span>_<span class="cm-bracket">{</span><span class="cm-tag">\varepsilon</span> <span class="cm-tag">\to</span> <span class="cm-atom">0</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>" notation, it's just a way of saying "when <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span> is really really small."</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We know the following:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is what you want to make sure you're computing correctly. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- You can compute </span><span class="cm-delimit cm-delimit-open">$</span>J(<span class="cm-tag">\theta</span> + <span class="cm-tag">\varepsilon</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and </span><span class="cm-delimit cm-delimit-open">$</span>J(<span class="cm-tag">\theta</span> - <span class="cm-tag">\varepsilon</span>)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> (in the case that </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is a real number), since you're confident your implementation for </span><span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is correct. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Lets use equation (1) and a small value for <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span> to convince your CEO that your code for computing<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-trailing-space-new-line"> is correct!</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 422px;"></div><div class="CodeMirror-gutters" style="display: none; height: 435px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="1)-How-does-gradient-checking-work?">1) How does gradient checking work?<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#1)-How-does-gradient-checking-work?">¶</a></h2>
<p>Backpropagation computes the gradients <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mfrac" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-6" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-9" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-1">\frac{\partial J}{\partial \theta}</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\theta</script> denotes the parameters of the model. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">J</script> is computed using forward propagation and your loss function.</p>
<p>Because forward propagation is relatively easy to implement, you're confident you got that right, and so you're almost  100% sure that you're computing the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">J</script> correctly. Thus, you can use your code for computing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">J</script> to verify the code for computing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-23"><span class="mfrac" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-6">\frac{\partial J}{\partial \theta}</script>. </p>
<p>Let's look back at the definition of a derivative (or gradient):
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" role="math" style="width: 100%; display: inline-block; min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.313em;"><span style="position: absolute; clip: rect(2.503em 1012.21em 5.003em -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-32"><span class="mtable" id="MathJax-Span-33" style="min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.313em;"><span style="display: inline-block; position: absolute; width: 12.205em; height: 0px; clip: rect(-1.485em 1012.21em 1.015em -999.997em); top: 0.003em; left: 50%; margin-left: -6.068em;"><span style="position: absolute; clip: rect(2.503em 1012.21em 5.003em -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 12.205em; height: 0px;"><span style="position: absolute; clip: rect(2.443em 1012.21em 4.943em -999.997em); top: -3.926em; left: 50%; margin-left: -6.068em;"><span class="mtd" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mfrac" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-40"><span class="mi" id="MathJax-Span-41" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-42" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-45" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1001.07em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.074em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-47" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1001.31em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-48" style="font-family: STIXMathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1001.31em 4.289em -999.997em); top: -3.33em; left: 0.003em;"><span class="texatom" id="MathJax-Span-49"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span><span class="mo" id="MathJax-Span-52" style="font-size: 70.7%; font-family: STIXMathJax_Main;">→</span><span class="mn" id="MathJax-Span-53" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-54" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 7.801em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1007.62em 4.348em -999.997em); top: -4.64em; left: 50%; margin-left: -3.866em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-57" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-58" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-59" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-60" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-61" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-62" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-63" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-64" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-65" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-66" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-67" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-68" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-69"><span class="mn" id="MathJax-Span-70" style="font-family: STIXMathJax_Main;">2</span><span class="mi" id="MathJax-Span-71" style="font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1007.8em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 7.801em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em 1001.13em 0.42em -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em 1001.13em 4.348em -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-35"><span class="mtext" id="MathJax-Span-36" style="font-family: STIXMathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.068em; border-left: 0px solid; width: 0px; height: 2.718em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>ε</mi><mo stretchy="false">→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>ε</mi><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7"> \frac{\partial J}{\partial \theta} = \lim_{\varepsilon \to 0} \frac{J(\theta + \varepsilon) - J(\theta - \varepsilon)}{2 \varepsilon} \tag{1}</script></p>
<p>If you're not familiar with the "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-72" role="math" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em 1001.31em 3.158em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-73"><span class="mstyle" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="munderover" id="MathJax-Span-76"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1001.31em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-77" style="font-family: STIXMathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1001.31em 4.289em -999.997em); top: -3.33em; left: 0.003em;"><span class="texatom" id="MathJax-Span-78"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span><span class="mo" id="MathJax-Span-81" style="font-size: 70.7%; font-family: STIXMathJax_Main;">→</span><span class="mn" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.996em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>ε</mi><mo stretchy="false">→</mo><mn>0</mn></mrow></munder></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-8">\displaystyle \lim_{\varepsilon \to 0}</script>" notation, it's just a way of saying "when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.42em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">\varepsilon</script> is really really small."</p>
<p>We know the following:</p>
<ul>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-87"><span class="mfrac" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-10">\frac{\partial J}{\partial \theta}</script> is what you want to make sure you're computing correctly. </li>
<li>You can compute <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-95" role="math" style="width: 3.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.277em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1003.22em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-98" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-99" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-100" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-101" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-102" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>ε</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">J(\theta + \varepsilon)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" role="math" style="width: 3.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.277em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1003.22em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-106" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-108" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-109" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-110" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">J(\theta - \varepsilon)</script> (in the case that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\theta</script> is a real number), since you're confident your implementation for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">J</script> is correct. </li>
</ul>
<p>Lets use equation (1) and a small value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.42em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\varepsilon</script> to convince your CEO that your code for computing  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-120" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-121"><span class="mfrac" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-128" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-16">\frac{\partial J}{\partial \theta}</script> is correct!</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 269px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2) 1-dimensional gradient checking</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Consider a 1D linear function <span class="cm-delimit cm-delimit-open">$</span>J(<span class="cm-tag">\theta</span>) = <span class="cm-tag">\theta</span> x<span class="cm-delimit cm-delimit-close">$</span>. The model contains only a single real-valued parameter <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span>, and takes <span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span> as input.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You will implement code to compute <span class="cm-delimit cm-delimit-open">$</span>J(.)<span class="cm-delimit cm-delimit-close">$</span> and its derivative <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>. You will then use gradient checking to make sure your derivative computation for <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> is correct. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/1Dgrad_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:600px;height:250px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 1** <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span>: **1D linear model**<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The diagram above shows the key computation steps: First start with <span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span>, then evaluate the function <span class="cm-delimit cm-delimit-open">$</span>J(x)<span class="cm-delimit cm-delimit-close">$</span> ("forward propagation"). Then compute the derivative <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> ("backward propagation"). </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: implement "forward propagation" and "backward propagation" for this simple function. I.e., compute both <span class="cm-delimit cm-delimit-open">$</span>J(.)<span class="cm-delimit cm-delimit-close">$</span> ("forward propagation") and its derivative with respect to <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span> ("backward propagation"), in two separate functions. </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 269px;"></div><div class="CodeMirror-gutters" style="display: none; height: 282px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="2)-1-dimensional-gradient-checking">2) 1-dimensional gradient checking<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#2)-1-dimensional-gradient-checking">¶</a></h2>
<p>Consider a 1D linear function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-640" role="math" style="width: 4.646em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.872em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1003.87em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-641"><span class="mi" id="MathJax-Span-642" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-643" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-644" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-645" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-646" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-647" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-648" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>θ</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">J(\theta) = \theta x</script>. The model contains only a single real-valued parameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-649" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-650"><span class="mi" id="MathJax-Span-651" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">\theta</script>, and takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-652" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-653"><span class="mi" id="MathJax-Span-654" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">x</script> as input.</p>
<p>You will implement code to compute <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-655" role="math" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1001.55em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-656"><span class="mi" id="MathJax-Span-657" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-658" style="font-family: STIXMathJax_Main;">(</span><span class="mo" id="MathJax-Span-659" style="font-family: STIXMathJax_Main;">.</span><span class="mo" id="MathJax-Span-660" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mo>.</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">J(.)</script> and its derivative <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-661" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-662"><span class="mfrac" id="MathJax-Span-663"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-664"><span class="mi" id="MathJax-Span-665" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-666" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-669" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-60">\frac{\partial J}{\partial \theta}</script>. You will then use gradient checking to make sure your derivative computation for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-670" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-671"><span class="mi" id="MathJax-Span-672" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">J</script> is correct. </p>
<p><img src="./Gradient Checking v1_files/1Dgrad_kiank.png" style="width: 600px ; height: 250px"></p>
<center> <u> <strong>Figure 1</strong> </u>: <strong>1D linear model</strong><br> </center>

<p>The diagram above shows the key computation steps: First start with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-673" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">x</script>, then evaluate the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-676" role="math" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1001.55em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-679" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-680" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-681" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">J(x)</script> ("forward propagation"). Then compute the derivative <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-682" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-683"><span class="mfrac" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-690" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-64">\frac{\partial J}{\partial \theta}</script> ("backward propagation"). </p>
<p><strong>Exercise</strong>: implement "forward propagation" and "backward propagation" for this simple function. I.e., compute both <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-691" role="math" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1001.55em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-692"><span class="mi" id="MathJax-Span-693" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-694" style="font-family: STIXMathJax_Main;">(</span><span class="mo" id="MathJax-Span-695" style="font-family: STIXMathJax_Main;">.</span><span class="mo" id="MathJax-Span-696" style="font-family: STIXMathJax_Main; padding-left: 0.182em;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mo>.</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">J(.)</script> ("forward propagation") and its derivative with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-698"><span class="mi" id="MathJax-Span-699" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">\theta</script> ("backward propagation"), in two separate functions. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 167.406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 710px; margin-bottom: -17px; border-right-width: 13px; min-height: 334px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 29px; top: 34px; width: 132.813px; height: 17px;"></div></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: forward_propagation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">forward_propagation</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the linear forward propagation (compute J) presented in Figure 1 (J(theta) = theta * x)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- a real-valued input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    theta -- our parameter, a real number as well</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    J -- the value of function J, computed using the formula J(theta) = theta * x</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">J</span> = <span class="cm-variable">theta</span><span class="cm-operator">*</span><span class="cm-variable">x</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">J</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 334px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 234px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span>, <span class="cm-variable">theta</span> = <span class="cm-number">2</span>, <span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">J</span> = <span class="cm-variable">forward_propagation</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"J = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">J</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>J = 8
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span> <span class="cm-attribute">style</span>=<span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>  ** J ** &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span> 8<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>  <strong> J </strong>  </td>
        <td> 8</td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Now, implement the backward propagation step (derivative computation) of Figure 1. That is, compute the derivative of <span class="cm-delimit cm-delimit-open">$</span>J(<span class="cm-tag">\theta</span>) = <span class="cm-tag">\theta</span> x<span class="cm-delimit cm-delimit-close">$</span> with respect to <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span>. To save you from doing the calculus, you should get <span class="cm-delimit cm-delimit-open">$</span>dtheta = <span class="cm-tag">\frac</span> <span class="cm-bracket">{</span> <span class="cm-tag">\partial</span> J&nbsp;<span class="cm-bracket">}{</span> <span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span> = x<span class="cm-delimit cm-delimit-close">$</span>.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: Now, implement the backward propagation step (derivative computation) of Figure 1. That is, compute the derivative of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-189" role="math" style="width: 4.646em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.872em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1003.87em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-192" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-193" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-195" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-196" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-197" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>θ</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">J(\theta) = \theta x</script> with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">\theta</script>. To save you from doing the calculus, you should get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" role="math" style="width: 7.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em 1006.55em 3.098em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-204" style="font-family: STIXMathJax_Main-italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-205" style="font-family: STIXMathJax_Main-italic;">h</span><span class="mi" id="MathJax-Span-206" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mi" id="MathJax-Span-207" style="font-family: STIXMathJax_Main-italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-208" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mo" id="MathJax-Span-209" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-210" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-218" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">dtheta = \frac { \partial J }{ \partial \theta} = x</script>.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 260.594px; left: 103.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 493px; margin-bottom: -17px; border-right-width: 13px; min-height: 334px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 98px; top: 255px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: backward_propagation</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">backward_propagation</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Computes the derivative of J with respect to theta (see Figure 1).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- a real-valued input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    theta -- our parameter, a real number as well</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    dtheta -- the gradient of the cost with respect to theta</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dtheta</span> = <span class="cm-variable">x</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">dtheta</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 334px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 276px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span>, <span class="cm-variable">theta</span> = <span class="cm-number">2</span>, <span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dtheta</span> = <span class="cm-variable">backward_propagation</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"dtheta = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">dtheta</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>dtheta = 2
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>  ** dtheta ** &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span> 2 <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>  <strong> dtheta </strong>  </td>
        <td> 2 </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 351px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: To show that the <span class="cm-comment">`backward_propagation()`</span> function is correctly computing the gradient <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span>, let's implement gradient checking.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- First compute "gradapprox" using the formula above (1) and a small value of </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">. Here are the Steps to follow:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">1. </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span> = <span class="cm-tag">\theta</span> + <span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">2. </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>-<span class="cm-bracket">}</span> = <span class="cm-tag">\theta</span> - <span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">3. </span><span class="cm-delimit cm-delimit-open">$</span>J^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span> = J(<span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">4. </span><span class="cm-delimit cm-delimit-open">$</span>J^<span class="cm-bracket">{</span>-<span class="cm-bracket">}</span> = J(<span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>-<span class="cm-bracket">}</span>)<span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">5. </span><span class="cm-delimit cm-delimit-open">$</span>gradapprox = <span class="cm-tag">\frac</span><span class="cm-bracket">{</span>J^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span> - J^<span class="cm-bracket">{</span>-<span class="cm-bracket">}}{</span><span class="cm-atom">2</span> &nbsp;<span class="cm-tag">\varepsilon</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Then compute the gradient using backward propagation, and store the result in a variable "grad"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Finally, compute the relative difference between "gradapprox" and the "grad" using the following formula:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> difference = <span class="cm-tag">\frac</span> <span class="cm-bracket">{</span><span class="cm-tag">\mid\mid</span> grad - gradapprox <span class="cm-tag">\mid\mid</span>_2<span class="cm-bracket">}{</span><span class="cm-tag">\mid\mid</span> grad <span class="cm-tag">\mid\mid</span>_2 + <span class="cm-tag">\mid\mid</span> gradapprox <span class="cm-tag">\mid\mid</span>_2<span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">2</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You will need 3 Steps to compute this formula:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- 1'. compute the numerator using np.linalg.norm(...)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- 2'. compute the denominator. You will need to call np.linalg.norm(...) twice.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable-3">- 3'. divide them.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- If this difference is small (say less than </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-atom">10</span>^<span class="cm-bracket">{</span>-7<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2">), you can be quite confident that you have computed your gradient correctly. Otherwise, there may be a mistake in the gradient computation. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 351px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Exercise</strong>: To show that the <code>backward_propagation()</code> function is correctly computing the gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-219" role="math" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.01em 2.801em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-220"><span class="mfrac" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-224" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-31">\frac{\partial J}{\partial \theta}</script>, let's implement gradient checking.</p>
<p><strong>Instructions</strong>:</p>
<ul>
<li>First compute "gradapprox" using the formula above (1) and a small value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-228" role="math" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.729em 1000.42em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">\varepsilon</script>. Here are the Steps to follow:<ol>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" role="math" style="width: 5.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em 1004.53em 2.741em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-232"><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-234" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mo" id="MathJax-Span-237" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-239" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-240" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-241" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo>=</mo><mi>θ</mi><mo>+</mo><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">\theta^{+} = \theta + \varepsilon</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-242" role="math" style="width: 5.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1004.53em 2.682em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-243"><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-245" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-246"><span class="mrow" id="MathJax-Span-247"><span class="mo" id="MathJax-Span-248" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-249" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-250" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-251" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-252" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msup><mo>=</mo><mi>θ</mi><mo>−</mo><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">\theta^{-} = \theta - \varepsilon</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-253" role="math" style="width: 5.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.705em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em 1004.65em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-254"><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-256" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mo" id="MathJax-Span-259" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-260" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-261" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-262" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-264" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mo" id="MathJax-Span-267" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo>=</mo><mi>J</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">J^{+} = J(\theta^{+})</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-269" role="math" style="width: 5.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.705em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em 1004.65em 2.86em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-270"><span class="msubsup" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mo" id="MathJax-Span-275" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-277" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-278" style="font-family: STIXMathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-280" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-284" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msup><mo>=</mo><mi>J</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">J^{-} = J(\theta^{-})</script></li>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-285" role="math" style="width: 10.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.455em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em 1008.46em 3.098em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-family: STIXMathJax_Main-italic;">g</span><span class="mi" id="MathJax-Span-288" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-289" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-290" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-291" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-292" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-293" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-294" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-295" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-296" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-297" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-298" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.277em 1002.09em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -1.068em;"><span class="mrow" id="MathJax-Span-299"><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.42em;"><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mo" id="MathJax-Span-304" style="font-size: 50%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-307" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.42em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="font-size: 50%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-311"><span class="mn" id="MathJax-Span-312" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1002.21em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.205em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mo>=</mo><mfrac><mrow><msup><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo>−</mo><msup><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msup></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-37">gradapprox = \frac{J^{+} - J^{-}}{2  \varepsilon}</script></li>
</ol>
</li>
<li>Then compute the gradient using backward propagation, and store the result in a variable "grad"</li>
<li>Finally, compute the relative difference between "gradapprox" and the "grad" using the following formula:
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2223;&lt;/mo&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2223;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2223;&lt;/mo&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2223;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2223;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" role="math" style="width: 100%; display: inline-block; min-width: 22.324em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 22.324em;"><span style="position: absolute; clip: rect(2.443em 1018.22em 5.063em -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-315"><span class="mtable" id="MathJax-Span-316" style="min-width: 22.324em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.324em;"><span style="display: inline-block; position: absolute; width: 18.217em; height: 0px; clip: rect(-1.545em 1018.22em 1.074em -999.997em); top: 0.003em; left: 50%; margin-left: -9.104em;"><span style="position: absolute; clip: rect(2.443em 1018.22em 5.063em -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 18.217em; height: 0px;"><span style="position: absolute; clip: rect(2.443em 1018.22em 5.063em -999.997em); top: -3.985em; left: 50%; margin-left: -9.104em;"><span class="mtd" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-323" style="font-family: STIXMathJax_Main-italic;">i</span><span class="mi" id="MathJax-Span-324" style="font-family: STIXMathJax_Main-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-325" style="font-family: STIXMathJax_Main-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-326" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mi" id="MathJax-Span-327" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-328" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mi" id="MathJax-Span-329" style="font-family: STIXMathJax_Main-italic;">n</span><span class="mi" id="MathJax-Span-330" style="font-family: STIXMathJax_Main-italic;">c</span><span class="mi" id="MathJax-Span-331" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mo" id="MathJax-Span-332" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-333" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 12.324em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.098em 1010em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -4.997em;"><span class="mrow" id="MathJax-Span-334"><span class="mo" id="MathJax-Span-335" style="font-family: STIXMathJax_Main;">∣</span><span class="mo" id="MathJax-Span-336" style="font-family: STIXMathJax_Main;">∣</span><span class="mi" id="MathJax-Span-337" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">g</span><span class="mi" id="MathJax-Span-338" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-339" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-340" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-341" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-342" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">g</span><span class="mi" id="MathJax-Span-343" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-344" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-345" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-346" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-347" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-348" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-349" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-350" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-351" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-352" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">∣</span><span class="msubsup" id="MathJax-Span-353"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.18em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-354" style="font-family: STIXMathJax_Main;">∣</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.241em;"><span class="mn" id="MathJax-Span-355" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em 1012.21em 4.348em -999.997em); top: -3.271em; left: 50%; margin-left: -6.128em;"><span class="mrow" id="MathJax-Span-356"><span class="mo" id="MathJax-Span-357" style="font-family: STIXMathJax_Main;">∣</span><span class="mo" id="MathJax-Span-358" style="font-family: STIXMathJax_Main;">∣</span><span class="mi" id="MathJax-Span-359" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">g</span><span class="mi" id="MathJax-Span-360" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-361" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-362" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-363" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">∣</span><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.18em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-365" style="font-family: STIXMathJax_Main;">∣</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.241em;"><span class="mn" id="MathJax-Span-366" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-367" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">+</span><span class="mo" id="MathJax-Span-368" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">∣<span style="font-family: STIXMathJax_Main;">∣</span></span><span class="mi" id="MathJax-Span-369" style="font-family: STIXMathJax_Main-italic; padding-left: 0.301em;">g</span><span class="mi" id="MathJax-Span-370" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-371" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-372" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-373" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-374" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-375" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-376" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-377" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-378" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-379" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">∣</span><span class="msubsup" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.18em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-381" style="font-family: STIXMathJax_Main;">∣</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.241em;"><span class="mn" id="MathJax-Span-382" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1012.32em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 12.324em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em 1001.13em 0.36em -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em 1001.13em 4.348em -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-318"><span class="mtext" id="MathJax-Span-319" style="font-family: STIXMathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mo stretchy="false">∣</mo><mo>∣</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mo>−</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mo>∣</mo><msub><mo stretchy="false">∣</mo><mn>2</mn></msub></mrow><mrow><mo stretchy="false">∣</mo><mo>∣</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mo>∣</mo><msub><mo>∣</mo><mn>2</mn></msub><mo>+</mo><mo>∣∣</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mo>∣</mo><msub><mo stretchy="false">∣</mo><mn>2</mn></msub></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-38"> difference = \frac {\mid\mid grad - gradapprox \mid\mid_2}{\mid\mid grad \mid\mid_2 + \mid\mid gradapprox \mid\mid_2} \tag{2}</script>
You will need 3 Steps to compute this formula:<ul>
<li>1'. compute the numerator using np.linalg.norm(...)</li>
<li>2'. compute the denominator. You will need to call np.linalg.norm(...) twice.</li>
<li>3'. divide them.</li>
</ul>
</li>
<li>If this difference is small (say less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-383" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.91em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-384"><span class="msubsup" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-386" style="font-family: STIXMathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.015em;"><span class="texatom" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mo" id="MathJax-Span-389" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-390" style="font-size: 70.7%; font-family: STIXMathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>7</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">10^{-7}</script>), you can be quite confident that you have computed your gradient correctly. Otherwise, there may be a mistake in the gradient computation. </li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[26]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 34.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 857px; margin-bottom: -17px; border-right-width: 13px; min-height: 691px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 29px; top: 34px; width: 280px; height: 17px;"></div></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: gradient_check</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">gradient_check</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>, <span class="cm-variable">epsilon</span> = <span class="cm-number">1e-7</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the backward propagation presented in Figure 1.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- a real-valued input</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    theta -- our parameter, a real number as well</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    epsilon -- tiny shift to the input to compute approximated gradient with formula(1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    difference -- difference (2) between the approximated gradient and the backward propagation gradient</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute gradapprox using left side of formula (1). epsilon is small enough, you don't need to worry about the limit.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 5 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">thetaplus</span> = <span class="cm-variable">theta</span><span class="cm-operator">+</span><span class="cm-variable">epsilon</span>                               <span class="cm-comment"># Step 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">thetaminus</span> = <span class="cm-variable">theta</span><span class="cm-operator">-</span><span class="cm-variable">epsilon</span>                              <span class="cm-comment"># Step 2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">J_plus</span> = <span class="cm-variable">forward_propagation</span>(<span class="cm-variable">x</span>,<span class="cm-variable">thetaplus</span>)                                  <span class="cm-comment"># Step 3</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">J_minus</span> = <span class="cm-variable">forward_propagation</span>(<span class="cm-variable">x</span>,<span class="cm-variable">thetaminus</span>)                                  <span class="cm-comment"># Step 4</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradapprox</span> = (<span class="cm-variable">J_plus</span><span class="cm-operator">-</span><span class="cm-variable">J_minus</span>)<span class="cm-operator">/</span>(<span class="cm-number">2.</span><span class="cm-operator">*</span><span class="cm-variable">epsilon</span>)                              <span class="cm-comment"># Step 5</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Check if gradapprox is close enough to the output of backward_propagation()</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">grad</span> = <span class="cm-variable">backward_propagation</span>(<span class="cm-variable">x</span>,<span class="cm-variable">theta</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">numerator</span> = <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">grad</span><span class="cm-operator">-</span><span class="cm-variable">gradapprox</span>)                               <span class="cm-comment"># Step 1'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">denominator</span> = <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">grad</span>) <span class="cm-operator">+</span> <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">gradapprox</span>)                              <span class="cm-comment"># Step 2'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">difference</span> = <span class="cm-variable">numerator</span><span class="cm-operator">/</span><span class="cm-variable">denominator</span>                           <span class="cm-comment"># Step 3'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">difference</span> <span class="cm-operator">&lt;</span> <span class="cm-number">1e-7</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span> (<span class="cm-string">"The gradient is correct!"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span> (<span class="cm-string">"The gradient is wrong!"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">difference</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 691px;"></div><div class="CodeMirror-gutters" style="display: none; height: 704px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[27]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 283px; margin-bottom: -17px; border-right-width: 13px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">x</span>, <span class="cm-variable">theta</span> = <span class="cm-number">2</span>, <span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">difference</span> = <span class="cm-variable">gradient_check</span>(<span class="cm-variable">x</span>, <span class="cm-variable">theta</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"difference = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">difference</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The gradient is correct!
difference = 2.91933588329e-10
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The gradient is correct!</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>  ** difference ** &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span> 2.9193358103083e-10 <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected Output</strong>:
The gradient is correct!</p>
<table>
    <tbody><tr>
        <td>  <strong> difference </strong>  </td>
        <td> 2.9193358103083e-10 </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congrats, the difference is smaller than the <span class="cm-delimit cm-delimit-open">$</span><span class="cm-atom">10</span>^<span class="cm-bracket">{</span>-7<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span> threshold. So you can have high confidence that you've correctly computed the gradient in <span class="cm-comment">`backward_propagation()`</span>. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now, in the more general case, your cost function <span class="cm-delimit cm-delimit-open">$</span>J<span class="cm-delimit cm-delimit-close">$</span> has more than a single 1D input. When you are training a neural network, <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span> actually consists of multiple matrices <span class="cm-delimit cm-delimit-open">$</span>W^<span class="cm-bracket">{[</span>l<span class="cm-bracket">]}</span><span class="cm-delimit cm-delimit-close">$</span> and biases <span class="cm-delimit cm-delimit-open">$</span>b^<span class="cm-bracket">{[</span>l<span class="cm-bracket">]}</span><span class="cm-delimit cm-delimit-close">$</span>! It is important to know how to do a gradient check with higher-dimensional inputs. Let's do it!</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Congrats, the difference is smaller than the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" role="math" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1001.91em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-392"><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mn" id="MathJax-Span-394" style="font-family: STIXMathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.015em;"><span class="texatom" id="MathJax-Span-395"><span class="mrow" id="MathJax-Span-396"><span class="mo" id="MathJax-Span-397" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mn" id="MathJax-Span-398" style="font-size: 70.7%; font-family: STIXMathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>7</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-40">10^{-7}</script> threshold. So you can have high confidence that you've correctly computed the gradient in <code>backward_propagation()</code>. </p>
<p>Now, in the more general case, your cost function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" role="math" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.54em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">J</script> has more than a single 1D input. When you are training a neural network, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\theta</script> actually consists of multiple matrices <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-405" role="math" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1001.73em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-406"><span class="msubsup" id="MathJax-Span-407"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.9em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-408" style="font-family: STIXMathJax_Main-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.955em;"><span class="texatom" id="MathJax-Span-409"><span class="mrow" id="MathJax-Span-410"><span class="mo" id="MathJax-Span-411" style="font-size: 70.7%; font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-412" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXMathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-43">W^{[l]}</script> and biases <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" role="math" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em 1001.25em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-415"><span class="msubsup" id="MathJax-Span-416"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-417" style="font-family: STIXMathJax_Main-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.479em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="mo" id="MathJax-Span-420" style="font-size: 70.7%; font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXMathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-44">b^{[l]}</script>! It is important to know how to do a gradient check with higher-dimensional inputs. Let's do it!</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 31px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3) N-dimensional gradient checking</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 31px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="3)-N-dimensional-gradient-checking">3) N-dimensional gradient checking<a class="anchor-link" href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#3)-N-dimensional-gradient-checking">¶</a></h2>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The following figure describes the forward and backward propagation of your fraud detection model.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/NDgrad_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:600px;height:400px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 2** <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span>: **deep neural network**<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>*LINEAR -&gt; RELU -&gt; LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID*<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's look at your implementations for forward propagation and backward propagation. </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The following figure describes the forward and backward propagation of your fraud detection model.</p>
<p><img src="./Gradient Checking v1_files/NDgrad_kiank.png" style="width: 600px ; height: 400px"></p>
<center> <u> <strong>Figure 2</strong> </u>: <strong>deep neural network</strong><br><em>LINEAR -&gt; RELU -&gt; LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID</em></center>

<p>Let's look at your implementations for forward propagation and backward propagation. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[28]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 181.406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 689px; margin-bottom: -17px; border-right-width: 13px; min-height: 742px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 29px; top: 0px; width: 146.813px; height: 17px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">forward_propagation_n</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implements the forward propagation (and computes the cost) presented in Figure 3.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    X -- training set for m examples</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Y -- labels for m examples </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing your parameters "W1", "b1", "W2", "b2", "W3", "b3":</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    W1 -- weight matrix of shape (5, 4)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    b1 -- bias vector of shape (5, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    W2 -- weight matrix of shape (3, 5)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    b2 -- bias vector of shape (3, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    W3 -- weight matrix of shape (1, 3)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">                    b3 -- bias vector of shape (1, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cost -- the cost function (logistic cost for one example)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># retrieve parameters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">m</span> = <span class="cm-variable">X</span>.<span class="cm-property">shape</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">W1</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"W1"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">b1</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"b1"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">W2</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"W2"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">b2</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"b2"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">W3</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"W3"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">b3</span> = <span class="cm-variable">parameters</span>[<span class="cm-string">"b3"</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># LINEAR -&gt; RELU -&gt; LINEAR -&gt; RELU -&gt; LINEAR -&gt; SIGMOID</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Z1</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">W1</span>, <span class="cm-variable">X</span>) <span class="cm-operator">+</span> <span class="cm-variable">b1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">A1</span> = <span class="cm-variable">relu</span>(<span class="cm-variable">Z1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Z2</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">W2</span>, <span class="cm-variable">A1</span>) <span class="cm-operator">+</span> <span class="cm-variable">b2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">A2</span> = <span class="cm-variable">relu</span>(<span class="cm-variable">Z2</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">Z3</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">W3</span>, <span class="cm-variable">A2</span>) <span class="cm-operator">+</span> <span class="cm-variable">b3</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">A3</span> = <span class="cm-variable">sigmoid</span>(<span class="cm-variable">Z3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Cost</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">logprobs</span> = <span class="cm-variable">np</span>.<span class="cm-property">multiply</span>(<span class="cm-operator">-</span><span class="cm-variable">np</span>.<span class="cm-property">log</span>(<span class="cm-variable">A3</span>),<span class="cm-variable">Y</span>) <span class="cm-operator">+</span> <span class="cm-variable">np</span>.<span class="cm-property">multiply</span>(<span class="cm-operator">-</span><span class="cm-variable">np</span>.<span class="cm-property">log</span>(<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">A3</span>), <span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">Y</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cost</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">logprobs</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">cache</span> = (<span class="cm-variable">Z1</span>, <span class="cm-variable">A1</span>, <span class="cm-variable">W1</span>, <span class="cm-variable">b1</span>, <span class="cm-variable">Z2</span>, <span class="cm-variable">A2</span>, <span class="cm-variable">W2</span>, <span class="cm-variable">b2</span>, <span class="cm-variable">Z3</span>, <span class="cm-variable">A3</span>, <span class="cm-variable">W3</span>, <span class="cm-variable">b3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">cost</span>, <span class="cm-variable">cache</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 742px;"></div><div class="CodeMirror-gutters" style="display: none; height: 755px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now, run backward propagation.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Now, run backward propagation.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[29]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 934px; margin-bottom: -17px; border-right-width: 13px; min-height: 606px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">backward_propagation_n</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">cache</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Implement the backward propagation presented in figure 2.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    X -- input datapoint, of shape (input size, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Y -- true "label"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    cache -- cache output from forward_propagation_n()</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    gradients -- A dictionary with the gradients of the cost with respect to each parameter, activation and pre-activation variables.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">m</span> = <span class="cm-variable">X</span>.<span class="cm-property">shape</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">Z1</span>, <span class="cm-variable">A1</span>, <span class="cm-variable">W1</span>, <span class="cm-variable">b1</span>, <span class="cm-variable">Z2</span>, <span class="cm-variable">A2</span>, <span class="cm-variable">W2</span>, <span class="cm-variable">b2</span>, <span class="cm-variable">Z3</span>, <span class="cm-variable">A3</span>, <span class="cm-variable">W3</span>, <span class="cm-variable">b3</span>) = <span class="cm-variable">cache</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dZ3</span> = <span class="cm-variable">A3</span> <span class="cm-operator">-</span> <span class="cm-variable">Y</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dW3</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dZ3</span>, <span class="cm-variable">A2</span>.<span class="cm-property">T</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">db3</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dZ3</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>, <span class="cm-variable">keepdims</span> = <span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dA2</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">W3</span>.<span class="cm-property">T</span>, <span class="cm-variable">dZ3</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dZ2</span> = <span class="cm-variable">np</span>.<span class="cm-property">multiply</span>(<span class="cm-variable">dA2</span>, <span class="cm-variable">np</span>.<span class="cm-property">int64</span>(<span class="cm-variable">A2</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dW2</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dZ2</span>, <span class="cm-variable">A1</span>.<span class="cm-property">T</span>) <span class="cm-operator">*</span> <span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">db2</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dZ2</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>, <span class="cm-variable">keepdims</span> = <span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dA1</span> = <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">W2</span>.<span class="cm-property">T</span>, <span class="cm-variable">dZ2</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dZ1</span> = <span class="cm-variable">np</span>.<span class="cm-property">multiply</span>(<span class="cm-variable">dA1</span>, <span class="cm-variable">np</span>.<span class="cm-property">int64</span>(<span class="cm-variable">A1</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">dW1</span> = <span class="cm-number">1.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">dot</span>(<span class="cm-variable">dZ1</span>, <span class="cm-variable">X</span>.<span class="cm-property">T</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">db1</span> = <span class="cm-number">4.</span><span class="cm-operator">/</span><span class="cm-variable">m</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dZ1</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>, <span class="cm-variable">keepdims</span> = <span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradients</span> = {<span class="cm-string">"dZ3"</span>: <span class="cm-variable">dZ3</span>, <span class="cm-string">"dW3"</span>: <span class="cm-variable">dW3</span>, <span class="cm-string">"db3"</span>: <span class="cm-variable">db3</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                 <span class="cm-string">"dA2"</span>: <span class="cm-variable">dA2</span>, <span class="cm-string">"dZ2"</span>: <span class="cm-variable">dZ2</span>, <span class="cm-string">"dW2"</span>: <span class="cm-variable">dW2</span>, <span class="cm-string">"db2"</span>: <span class="cm-variable">db2</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                 <span class="cm-string">"dA1"</span>: <span class="cm-variable">dA1</span>, <span class="cm-string">"dZ1"</span>: <span class="cm-variable">dZ1</span>, <span class="cm-string">"dW1"</span>: <span class="cm-variable">dW1</span>, <span class="cm-string">"db1"</span>: <span class="cm-variable">db1</span>}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">gradients</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 606px;"></div><div class="CodeMirror-gutters" style="display: none; height: 619px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You obtained some results on the fraud detection test set but you are not 100% sure of your model. Nobody's perfect! Let's implement gradient checking to verify if your gradients are correct.</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You obtained some results on the fraud detection test set but you are not 100% sure of your model. Nobody's perfect! Let's implement gradient checking to verify if your gradients are correct.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 589px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**How does gradient checking work?**</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">As in 1) and 2), you want to compare "gradapprox" to the gradient computed by backpropagation. The formula is still:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> <span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span> = <span class="cm-tag">\lim</span>_<span class="cm-bracket">{</span><span class="cm-tag">\varepsilon</span> <span class="cm-tag">\to</span> <span class="cm-atom">0</span><span class="cm-bracket">}</span> <span class="cm-tag">\frac</span><span class="cm-bracket">{</span>J(<span class="cm-tag">\theta</span> + <span class="cm-tag">\varepsilon</span>) - J(<span class="cm-tag">\theta</span> - <span class="cm-tag">\varepsilon</span>)<span class="cm-bracket">}{</span><span class="cm-atom">2</span> <span class="cm-tag">\varepsilon</span><span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">1</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">However, <span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span><span class="cm-delimit cm-delimit-close">$</span> is not a scalar anymore. It is a dictionary called "parameters". We implemented a function "<span class="cm-comment">`dictionary_to_vector()`</span>" for you. It converts the "parameters" dictionary into a vector called "values", obtained by reshaping all parameters (W1, b1, W2, b2, W3, b3) into vectors and concatenating them.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The inverse function is "<span class="cm-comment">`vector_to_dictionary`</span>" which outputs back the "parameters" dictionary.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/dictionary_to_vector.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:600px;height:400px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> **Figure 2** <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span>: **dictionary_to_vector() and vector_to_dictionary()**<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> You will need these functions in gradient_check_n()<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We have also converted the "gradients" dictionary into a vector "grad" using gradients_to_vector(). You don't need to worry about that.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Exercise**</span>: Implement gradient_check_n().</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Instructions**</span>: Here is pseudo-code that will help you implement the gradient check.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">For each i in num_parameters:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- To compute </span><span class="cm-comment cm-variable-2">`J_plus[i]`</span><span class="cm-variable-2">:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">1. Set </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> to </span><span class="cm-comment cm-variable-3">`np.copy(parameters_values)`</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">2. Set </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span>_i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> to </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span>_i + <span class="cm-tag">\varepsilon</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">3. Calculate </span><span class="cm-delimit cm-delimit-open">$</span>J^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span>_i<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> using to </span><span class="cm-comment cm-variable-3">`forward_propagation_n(x, y, vector_to_dictionary(`</span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-3"> </span><span class="cm-comment cm-variable-3">`))`</span><span class="cm-variable-3">.</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-b">&nbsp;</span><span class="cm-variable-3 cm-trailing-space-a"> </span><span class="cm-variable-3 cm-trailing-space-b">&nbsp;</span><span class="cm-variable-3 cm-trailing-space-new-line"> </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- To compute </span><span class="cm-comment cm-variable-2">`J_minus[i]`</span><span class="cm-variable-2">: do the same thing with </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\theta</span>^<span class="cm-bracket">{</span>-<span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Compute </span><span class="cm-delimit cm-delimit-open">$</span>gradapprox<span class="cm-bracket">[</span>i<span class="cm-bracket">]</span> = <span class="cm-tag">\frac</span><span class="cm-bracket">{</span>J^<span class="cm-bracket">{</span>+<span class="cm-bracket">}</span>_i - J^<span class="cm-bracket">{</span>-<span class="cm-bracket">}</span>_i<span class="cm-bracket">}{</span><span class="cm-atom">2</span> <span class="cm-tag">\varepsilon</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Thus, you get a vector gradapprox, where gradapprox[i] is an approximation of the gradient with respect to <span class="cm-comment">`parameter_values[i]`</span>. You can now compare this gradapprox vector to the gradients vector from backpropagation. Just like for the 1D case (Steps 1', 2', 3'), compute: </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-delimit cm-delimit-open">$$</span> difference = <span class="cm-tag">\frac</span> <span class="cm-bracket">{</span>\| grad - gradapprox \|_2<span class="cm-bracket">}{</span>\| grad \|_2 + \| gradapprox \|_2 <span class="cm-bracket">}</span> <span class="cm-tag">\tag</span><span class="cm-bracket">{</span><span class="cm-atom">3</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$$</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 589px;"></div><div class="CodeMirror-gutters" style="display: none; height: 602px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>How does gradient checking work?</strong>.</p>
<p>As in 1) and 2), you want to compare "gradapprox" to the gradient computed by backpropagation. The formula is still:</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1_1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;lim&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" role="math" style="width: 100%; display: inline-block; min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 16.313em;"><span style="position: absolute; clip: rect(2.503em 1012.21em 5.003em -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-424"><span class="mtable" id="MathJax-Span-425" style="min-width: 16.313em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.313em;"><span style="display: inline-block; position: absolute; width: 12.205em; height: 0px; clip: rect(-1.485em 1012.21em 1.015em -999.997em); top: 0.003em; left: 50%; margin-left: -6.068em;"><span style="position: absolute; clip: rect(2.503em 1012.21em 5.003em -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 12.205em; height: 0px;"><span style="position: absolute; clip: rect(2.443em 1012.21em 4.943em -999.997em); top: -3.926em; left: 50%; margin-left: -6.068em;"><span class="mtd" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mfrac" id="MathJax-Span-431"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -4.64em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-434" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-437" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1001.07em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.074em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="munderover" id="MathJax-Span-439" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1001.31em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-440" style="font-family: STIXMathJax_Main;">lim</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1001.31em 4.289em -999.997em); top: -3.33em; left: 0.003em;"><span class="texatom" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span><span class="mo" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXMathJax_Main;">→</span><span class="mn" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXMathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-446" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 7.801em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em 1007.62em 4.348em -999.997em); top: -4.64em; left: 50%; margin-left: -3.866em;"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-449" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-450" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-451" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-452" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-453" style="font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-454" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-455" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-456" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-457" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-458" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-459" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span><span class="mo" id="MathJax-Span-460" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.158em 1000.96em 4.17em -999.997em); top: -3.271em; left: 50%; margin-left: -0.473em;"><span class="mrow" id="MathJax-Span-461"><span class="mn" id="MathJax-Span-462" style="font-family: STIXMathJax_Main;">2</span><span class="mi" id="MathJax-Span-463" style="font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1007.8em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 7.801em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em 1001.13em 0.42em -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em 1001.13em 4.348em -999.997em); top: -3.926em; right: 0.003em;"><span class="mtd" id="mjx-eqn-1_1"><span class="mrow" id="MathJax-Span-427"><span class="mtext" id="MathJax-Span-428" style="font-family: STIXMathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.068em; border-left: 0px solid; width: 0px; height: 2.718em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1_1"><mtext>(1)</mtext></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><munder><mo movablelimits="true" form="prefix">lim</mo><mrow class="MJX-TeXAtom-ORD"><mi>ε</mi><mo stretchy="false">→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>ε</mi><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45"> \frac{\partial J}{\partial \theta} = \lim_{\varepsilon \to 0} \frac{J(\theta + \varepsilon) - J(\theta - \varepsilon)}{2 \varepsilon} \tag{1}</script></p>
<p>However, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-464" role="math" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.491em 1000.48em 2.503em -999.997em); top: -2.318em; left: 0.003em;"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.324em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">\theta</script> is not a scalar anymore. It is a dictionary called "parameters". We implemented a function "<code>dictionary_to_vector()</code>" for you. It converts the "parameters" dictionary into a vector called "values", obtained by reshaping all parameters (W1, b1, W2, b2, W3, b3) into vectors and concatenating them.</p>
<p>The inverse function is "<code>vector_to_dictionary</code>" which outputs back the "parameters" dictionary.</p>
<p><img src="./Gradient Checking v1_files/dictionary_to_vector.png" style="width: 600px ; height: 400px"></p>
<center> <u> <strong>Figure 2</strong> </u>: <strong>dictionary_to_vector() and vector_to_dictionary()</strong><br> You will need these functions in gradient_check_n()</center>

<p>We have also converted the "gradients" dictionary into a vector "grad" using gradients_to_vector(). You don't need to worry about that.</p>
<p><strong>Exercise</strong>: Implement gradient_check_n().</p>
<p><strong>Instructions</strong>: Here is pseudo-code that will help you implement the gradient check.</p>
<p>For each i in num_parameters:</p>
<ul>
<li>To compute <code>J_plus[i]</code>:<ol>
<li>Set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-467" role="math" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1001.13em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-470" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-471"><span class="mrow" id="MathJax-Span-472"><span class="mo" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-47">\theta^{+}</script> to <code>np.copy(parameters_values)</code></li>
<li>Set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" role="math" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1001.13em 2.682em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-475"><span class="msubsup" id="MathJax-Span-476"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-477" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em 1000.54em 4.17em -999.997em); top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-478"><span class="mrow" id="MathJax-Span-479"><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.17em -999.997em); top: -3.688em; left: 0.479em;"><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>θ</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-48">\theta^{+}_i</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-482" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.741em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em 1002.74em 2.979em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-483"><span class="msubsup" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-485" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em 1000.54em 4.17em -999.997em); top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mo" id="MathJax-Span-488" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.17em -999.997em); top: -3.688em; left: 0.479em;"><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-491" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">ε</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>θ</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msubsup><mo>+</mo><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">\theta^{+}_i + \varepsilon</script></li>
<li>Calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" role="math" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1001.13em 2.682em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-493"><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-495" style="font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em 1000.54em 4.17em -999.997em); top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-496"><span class="mrow" id="MathJax-Span-497"><span class="mo" id="MathJax-Span-498" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.3em 4.17em -999.997em); top: -3.688em; left: 0.42em;"><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>J</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-50">J^{+}_i</script> using to <code>forward_propagation_n(x, y, vector_to_dictionary(</code><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-500" role="math" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1001.13em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-501"><span class="msubsup" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-503" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="mo" id="MathJax-Span-506" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-51">\theta^{+}</script> <code>))</code>.     </li>
</ol>
</li>
<li>To compute <code>J_minus[i]</code>: do the same thing with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-507" role="math" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em 1001.13em 2.384em -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-508"><span class="msubsup" id="MathJax-Span-509"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.48em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-510" style="font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.539em;"><span class="texatom" id="MathJax-Span-511"><span class="mrow" id="MathJax-Span-512"><span class="mo" id="MathJax-Span-513" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-52">\theta^{-}</script></li>
<li>Compute <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-514" role="math" style="width: 11.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.408em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em 1009.41em 3.098em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: STIXMathJax_Main-italic;">g</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-518" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-519" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-520" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-521" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-522" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-523" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-524" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-525" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-526" style="font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-527" style="font-family: STIXMathJax_Main-italic;">i</span><span class="mo" id="MathJax-Span-528" style="font-family: STIXMathJax_Main;">]</span><span class="mo" id="MathJax-Span-529" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-530" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.277em 1002.09em 4.408em -999.997em); top: -4.64em; left: 50%; margin-left: -1.068em;"><span class="mrow" id="MathJax-Span-531"><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-533" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.42em 4.17em -999.997em); top: -4.283em; left: 0.42em;"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mo" id="MathJax-Span-536" style="font-size: 50%; font-family: STIXMathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.18em 4.17em -999.997em); top: -3.807em; left: 0.301em;"><span class="mi" id="MathJax-Span-537" style="font-size: 50%; font-family: STIXMathJax_Main-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-538" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-539"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.36em 4.17em -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.693em 1000.42em 4.11em -999.997em); top: -4.283em; left: 0.42em;"><span class="texatom" id="MathJax-Span-541"><span class="mrow" id="MathJax-Span-542"><span class="mo" id="MathJax-Span-543" style="font-size: 50%; font-family: STIXMathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.18em 4.17em -999.997em); top: -3.807em; left: 0.301em;"><span class="mi" id="MathJax-Span-544" style="font-size: 50%; font-family: STIXMathJax_Main-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-545"><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mi" id="MathJax-Span-547" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1002.21em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.205em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 2.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mfrac><mrow><msubsup><mi>J</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msubsup><mo>−</mo><msubsup><mi>J</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo></mrow></msubsup></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-53">gradapprox[i] = \frac{J^{+}_i - J^{-}_i}{2 \varepsilon}</script></li>
</ul>
<p>Thus, you get a vector gradapprox, where gradapprox[i] is an approximation of the gradient with respect to <code>parameter_values[i]</code>. You can now compare this gradapprox vector to the gradients vector from backpropagation. Just like for the 1D case (Steps 1', 2', 3'), compute: 
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="width: 100%; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" role="math" style="width: 100%; display: inline-block; min-width: 21.015em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%; min-width: 21.015em;"><span style="position: absolute; clip: rect(2.443em 1016.85em 5.063em -999.997em); top: -3.985em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-549"><span class="mtable" id="MathJax-Span-550" style="min-width: 21.015em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.015em;"><span style="display: inline-block; position: absolute; width: 16.848em; height: 0px; clip: rect(-1.545em 1016.85em 1.074em -999.997em); top: 0.003em; left: 50%; margin-left: -8.449em;"><span style="position: absolute; clip: rect(2.443em 1016.85em 5.063em -999.997em); top: -3.985em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 16.848em; height: 0px;"><span style="position: absolute; clip: rect(2.443em 1016.85em 5.063em -999.997em); top: -3.985em; left: 50%; margin-left: -8.449em;"><span class="mtd" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-557" style="font-family: STIXMathJax_Main-italic;">i</span><span class="mi" id="MathJax-Span-558" style="font-family: STIXMathJax_Main-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-559" style="font-family: STIXMathJax_Main-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span class="mi" id="MathJax-Span-560" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mi" id="MathJax-Span-561" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-562" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mi" id="MathJax-Span-563" style="font-family: STIXMathJax_Main-italic;">n</span><span class="mi" id="MathJax-Span-564" style="font-family: STIXMathJax_Main-italic;">c</span><span class="mi" id="MathJax-Span-565" style="font-family: STIXMathJax_Main-italic;">e</span><span class="mo" id="MathJax-Span-566" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-567" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 11.015em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.098em 1009.41em 4.348em -999.997em); top: -4.699em; left: 50%; margin-left: -4.699em;"><span class="mrow" id="MathJax-Span-568"><span class="mo" id="MathJax-Span-569" style="font-family: STIXMathJax_Main;">∥</span><span class="mi" id="MathJax-Span-570" style="font-family: STIXMathJax_Main-italic;">g</span><span class="mi" id="MathJax-Span-571" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-572" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-573" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-574" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">−</span><span class="mi" id="MathJax-Span-575" style="font-family: STIXMathJax_Main-italic; padding-left: 0.241em;">g</span><span class="mi" id="MathJax-Span-576" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-577" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-578" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-579" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-580" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-581" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-582" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-583" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-584" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-586" style="font-family: STIXMathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-587" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em 1010.9em 4.348em -999.997em); top: -3.271em; left: 50%; margin-left: -5.414em;"><span class="mrow" id="MathJax-Span-588"><span class="mo" id="MathJax-Span-589" style="font-family: STIXMathJax_Main;">∥</span><span class="mi" id="MathJax-Span-590" style="font-family: STIXMathJax_Main-italic;">g</span><span class="mi" id="MathJax-Span-591" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-592" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-593" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-594"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-595" style="font-family: STIXMathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-596" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-597" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">+</span><span class="mo" id="MathJax-Span-598" style="font-family: STIXMathJax_Main; padding-left: 0.241em;">∥</span><span class="mi" id="MathJax-Span-599" style="font-family: STIXMathJax_Main-italic;">g</span><span class="mi" id="MathJax-Span-600" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-601" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-602" style="font-family: STIXMathJax_Main-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-603" style="font-family: STIXMathJax_Main-italic;">a</span><span class="mi" id="MathJax-Span-604" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-605" style="font-family: STIXMathJax_Main-italic;">p</span><span class="mi" id="MathJax-Span-606" style="font-family: STIXMathJax_Main-italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-607" style="font-family: STIXMathJax_Main-italic;">o</span><span class="mi" id="MathJax-Span-608" style="font-family: STIXMathJax_Main-italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.42em 4.348em -999.997em); top: -3.985em; left: 0.003em;"><span class="mo" id="MathJax-Span-610" style="font-family: STIXMathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-611" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1011.01em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 11.015em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.193em; height: 0px; clip: rect(-0.83em 1001.13em 0.36em -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.158em 1001.13em 4.348em -999.997em); top: -3.985em; right: 0.003em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-552"><span class="mtext" id="MathJax-Span-553" style="font-family: STIXMathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.861em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-3"><mtext>(3)</mtext></mtd><mtd><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mo fence="false" stretchy="false">∥</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mo>−</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><msub><mo fence="false" stretchy="false">∥</mo><mn>2</mn></msub></mrow><mrow><mo fence="false" stretchy="false">∥</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><msub><mo>∥</mo><mn>2</mn></msub><mo>+</mo><mo>∥</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><msub><mo fence="false" stretchy="false">∥</mo><mn>2</mn></msub></mrow></mfrac></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54"> difference = \frac {\| grad - gradapprox \|_2}{\| grad \|_2 + \| gradapprox \|_2 } \tag{3}</script></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[45]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 753.594px; left: 341.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 899px; margin-bottom: -17px; border-right-width: 13px; min-height: 1048px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 336px; top: 748px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: gradient_check_n</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">gradient_check_n</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">epsilon</span> = <span class="cm-number">1e-7</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Checks if backward_propagation_n computes correctly the gradient of the cost output by forward_propagation_n</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    parameters -- python dictionary containing your parameters "W1", "b1", "W2", "b2", "W3", "b3":</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    grad -- output of backward_propagation_n, contains gradients of the cost with respect to the parameters. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    x -- input datapoint, of shape (input size, 1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    y -- true "label"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    epsilon -- tiny shift to the input to compute approximated gradient with formula(1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    difference -- difference (2) between the approximated gradient and the backward propagation gradient</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Set-up variables</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">parameters_values</span>, <span class="cm-variable">_</span> = <span class="cm-variable">dictionary_to_vector</span>(<span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">grad</span> = <span class="cm-variable">gradients_to_vector</span>(<span class="cm-variable">gradients</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">num_parameters</span> = <span class="cm-variable">parameters_values</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">J_plus</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">num_parameters</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">J_minus</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">num_parameters</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">gradapprox</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">num_parameters</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compute gradapprox</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">num_parameters</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute J_plus[i]. Inputs: "parameters_values, epsilon". Output = "J_plus[i]".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># "_" is used because the function you have to outputs two parameters but we only care about the first one</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### START CODE HERE ### (approx. 3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">thetaplus</span> = <span class="cm-variable">np</span>.<span class="cm-property">copy</span>(<span class="cm-variable">parameters_values</span>)                                      <span class="cm-comment"># Step 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">thetaplus</span>[<span class="cm-variable">i</span>][<span class="cm-number">0</span>] = <span class="cm-variable">thetaplus</span>[<span class="cm-variable">i</span>][<span class="cm-number">0</span>]<span class="cm-operator">+</span> <span class="cm-variable">epsilon</span>                               <span class="cm-comment"># Step 2</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">J_plus</span>[<span class="cm-variable">i</span>], <span class="cm-variable">_</span> = <span class="cm-variable">forward_propagation_n</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>,<span class="cm-variable">vector_to_dictionary</span>(<span class="cm-variable">thetaplus</span>))                                   <span class="cm-comment"># Step 3</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute J_minus[i]. Inputs: "parameters_values, epsilon". Output = "J_minus[i]".</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### START CODE HERE ### (approx. 3 lines)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">thetaminus</span> = <span class="cm-variable">np</span>.<span class="cm-property">copy</span>(<span class="cm-variable">parameters_values</span>)                                      <span class="cm-comment"># Step 1</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">thetaminus</span>[<span class="cm-variable">i</span>][<span class="cm-number">0</span>] = <span class="cm-variable">thetaminus</span>[<span class="cm-variable">i</span>][<span class="cm-number">0</span>]<span class="cm-operator">-</span> <span class="cm-variable">epsilon</span>                                   <span class="cm-comment"># Step 2        </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">J_minus</span>[<span class="cm-variable">i</span>], <span class="cm-variable">_</span> = <span class="cm-variable">forward_propagation_n</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>,<span class="cm-variable">vector_to_dictionary</span>(<span class="cm-variable">thetaminus</span>))                                     <span class="cm-comment"># Step 3</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment"># Compute gradapprox[i]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### START CODE HERE ### </span><span class="cm-comment CodeMirror-matchingbracket">(</span><span class="cm-comment">approx. 1 line</span><span class="cm-comment CodeMirror-matchingbracket">)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">gradapprox</span>[<span class="cm-variable">i</span>] = (<span class="cm-variable">J_plus</span>[<span class="cm-variable">i</span>]<span class="cm-operator">-</span><span class="cm-variable">J_minus</span>[<span class="cm-variable">i</span>])<span class="cm-operator">/</span>(<span class="cm-number">2.</span><span class="cm-operator">*</span><span class="cm-variable">epsilon</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># Compare gradapprox to backward propagation gradients by computing difference.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE ### (approx. 1 line)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">numerator</span> = <span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">grad</span><span class="cm-operator">-</span><span class="cm-variable">gradapprox</span>)                                           <span class="cm-comment"># Step 1'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">denominator</span> = (<span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">grad</span>)<span class="cm-operator">+</span><span class="cm-variable">np</span>.<span class="cm-property">linalg</span>.<span class="cm-property">norm</span>(<span class="cm-variable">gradapprox</span>))                                         <span class="cm-comment"># Step 2'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">difference</span> = <span class="cm-variable">numerator</span><span class="cm-operator">/</span><span class="cm-variable">denominator</span>                                          <span class="cm-comment"># Step 3'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE ###</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">difference</span> <span class="cm-operator">&gt;</span> <span class="cm-number">2e-7</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span> (<span class="cm-string">"\033[93m"</span> <span class="cm-operator">+</span> <span class="cm-string">"There is a mistake in the backward propagation! difference = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">difference</span>) <span class="cm-operator">+</span> <span class="cm-string">"\033[0m"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin">print</span> (<span class="cm-string">"\033[92m"</span> <span class="cm-operator">+</span> <span class="cm-string">"Your backward propagation works perfectly fine! difference = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">difference</span>) <span class="cm-operator">+</span> <span class="cm-string">"\033[0m"</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">difference</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 1048px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1061px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[46]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 409px; margin-bottom: -17px; border-right-width: 13px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span> = <span class="cm-variable">gradient_check_n_test_case</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span>, <span class="cm-variable">cache</span> = <span class="cm-variable">forward_propagation_n</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">parameters</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = <span class="cm-variable">backward_propagation_n</span>(<span class="cm-variable">X</span>, <span class="cm-variable">Y</span>, <span class="cm-variable">cache</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">difference</span> = <span class="cm-variable">gradient_check_n</span>(<span class="cm-variable">parameters</span>, <span class="cm-variable">gradients</span>, <span class="cm-variable">X</span>, <span class="cm-variable">Y</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre><span class="ansi-yellow-intense-fg">There is a mistake in the backward propagation! difference = 0.285093156781</span>
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Expected output**</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>  ** There is a mistake in the backward propagation!** &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span> difference = 0.285093156781 <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>Expected output</strong>:</p>
<table>
    <tbody><tr>
        <td>  <strong> There is a mistake in the backward propagation!</strong>  </td>
        <td> difference = 0.285093156781 </td>
    </tr>
</tbody></table></div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -17px; border-right-width: 13px; min-height: 402px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">It seems that there were errors in the <span class="cm-comment">`backward_propagation_n`</span> code we gave you! Good that you've implemented the gradient check. Go back to <span class="cm-comment">`backward_propagation`</span> and try to find/correct the errors <span class="cm-em">*(Hint: check dW2 and db1)*</span>. Rerun the gradient check when you think you've fixed it. Remember you'll need to re-execute the cell defining <span class="cm-comment">`backward_propagation_n()`</span> if you modify the code. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Can you get gradient check to declare your derivative computation correct? Even though this part of the assignment isn't graded, we strongly urge you to try to find the bug and re-run gradient check until you're convinced backprop is now correctly implemented. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-strong">**Note**</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Gradient Checking is slow! Approximating the gradient with </span><span class="cm-delimit cm-delimit-open">$</span><span class="cm-tag">\frac</span><span class="cm-bracket">{</span><span class="cm-tag">\partial</span> J<span class="cm-bracket">}{</span><span class="cm-tag">\partial</span> <span class="cm-tag">\theta</span><span class="cm-bracket">}</span> <span class="cm-tag">\approx</span> &nbsp;<span class="cm-tag">\frac</span><span class="cm-bracket">{</span>J(<span class="cm-tag">\theta</span> + <span class="cm-tag">\varepsilon</span>) - J(<span class="cm-tag">\theta</span> - <span class="cm-tag">\varepsilon</span>)<span class="cm-bracket">}{</span><span class="cm-atom">2</span> <span class="cm-tag">\varepsilon</span><span class="cm-bracket">}</span><span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> is computationally costly. For this reason, we don't run gradient checking at every iteration during training. Just a few times to check if the gradient is correct. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2">- Gradient Checking, at least as we've presented it, doesn't work with dropout. You would usually run the gradient check algorithm without dropout to make sure your backprop is correct, then add dropout. </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Congrats, you can be confident that your deep learning model for fraud detection is working correctly! You can even use this to convince your CEO. :) </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'blue'</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">**What you should remember from this notebook**:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Gradient checking verifies closeness between the gradients from backpropagation and the numerical approximation of the gradient (computed using forward propagation).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">- Gradient checking is slow, so we don't run it in every iteration of training. You would usually run it only to make sure your code is correct, then turn it off and use backprop for the actual learning process. </span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 402px;"></div><div class="CodeMirror-gutters" style="display: none; height: 415px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>It seems that there were errors in the <code>backward_propagation_n</code> code we gave you! Good that you've implemented the gradient check. Go back to <code>backward_propagation</code> and try to find/correct the errors <em>(Hint: check dW2 and db1)</em>. Rerun the gradient check when you think you've fixed it. Remember you'll need to re-execute the cell defining <code>backward_propagation_n()</code> if you modify the code. </p>
<p>Can you get gradient check to declare your derivative computation correct? Even though this part of the assignment isn't graded, we strongly urge you to try to find the bug and re-run gradient check until you're convinced backprop is now correctly implemented. </p>
<p><strong>Note</strong> </p>
<ul>
<li>Gradient Checking is slow! Approximating the gradient with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-612" role="math" style="width: 8.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em 1007.09em 3.098em -999.997em); top: -2.497em; left: 0.003em;"><span class="mrow" id="MathJax-Span-613"><span class="mfrac" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -4.402em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-617" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-size: 70.7%; font-family: STIXMathJax_Main;">∂</span><span class="mi" id="MathJax-Span-620" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1000.78em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.777em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-621" style="font-family: STIXMathJax_Main; padding-left: 0.301em;">≈</span><span class="mfrac" id="MathJax-Span-622" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 4.527em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em 1004.41em 4.289em -999.997em); top: -4.521em; left: 50%; margin-left: -2.199em;"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-625" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-627" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span><span class="mo" id="MathJax-Span-629" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span><span class="mo" id="MathJax-Span-630" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mi" id="MathJax-Span-631" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-633" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-634" style="font-size: 70.7%; font-family: STIXMathJax_Main;">−</span><span class="mi" id="MathJax-Span-635" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span><span class="mo" id="MathJax-Span-636" style="font-size: 70.7%; font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.66em 4.17em -999.997em); top: -3.568em; left: 50%; margin-left: -0.354em;"><span class="mrow" id="MathJax-Span-637"><span class="mn" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em 1004.53em 1.253em -999.997em); top: -1.307em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 4.527em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>≈</mo><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>ε</mi><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-55">\frac{\partial J}{\partial \theta} \approx  \frac{J(\theta + \varepsilon) - J(\theta - \varepsilon)}{2 \varepsilon}</script> is computationally costly. For this reason, we don't run gradient checking at every iteration during training. Just a few times to check if the gradient is correct. </li>
<li>Gradient Checking, at least as we've presented it, doesn't work with dropout. You would usually run the gradient check algorithm without dropout to make sure your backprop is correct, then add dropout. </li>
</ul>
<p>Congrats, you can be confident that your deep learning model for fraud detection is working correctly! You can even use this to convince your CEO. :) </p>
<p><font color="blue">
<strong>What you should remember from this notebook</strong>:
</font></p><ul><font color="blue">
<li>Gradient checking verifies closeness between the gradients from backpropagation and the numerical approximation of the gradient (computed using forward propagation).</li>
<li>Gradient checking is slow, so we don't run it in every iteration of training. You would usually run it only to make sure your code is correct, then turn it off and use backprop for the actual learning process. </li>
</font></ul><font color="blue">
</font><p></p></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 3px; margin-bottom: -17px; border-right-width: 13px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 41px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://hub.coursera-notebooks.org/user/dwhpzgfgrvvvjixquyviwa/notebooks/week5/Gradient%20Checking/Gradient%20Checking%20v1.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "5.0.0", "notebook_path": "/opt/conda/lib/python3.6/site-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.0 |Anaconda custom (64-bit)| (default, Dec 23 2016, 12:22:00) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]", "sys_executable": "/opt/conda/bin/python3", "sys_platform": "linux", "platform": "Linux-4.4.0-45-generic-x86_64-with-debian-8.8", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./Gradient Checking v1_files/encoding.js.下载" charset="utf-8"></script>

<script src="./Gradient Checking v1_files/main.min.js.下载" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXMathJax_Main-italic, sans-serif;"></div></div><div class="widget-modal-backdrop widget-modal-hidden"><div class="widget-modal-text"><i class="fa fa-cog fa-spin"></i><div>Rendering widgets...</div></div><div class="progress widget-modal-progress"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div></div></body></html>